---
title: 测试
toc: menu
order: 5
---

## 表单测试计划

#### 一般性测试

- 所有可见字段是否显示为中文 (如状态为 Open, 显示为中文 “草稿”）
- 用户输入的参数错误不能向用户直接显示为 “Bad Request”，在 Api 层面向用户展示可理解的中文提示 （如 “没有输入电话号码”）
- 输入框提示规范化标准： [名称 编号 类型] 统一用空格分开, x [名称/编号/类型], x [名称,编号,类型] ,,,（ x 代替非规范, 下同)
- 输入框提示无需重复, e.g. 名称 [___________] 留空即可， x 名称：[____请输入名称____]

#### 实体列表测试

> 列表的一般性测试计划

##### **_数据库设计_**

> 需检查代码数据库 .sql 文件

- 实体列表是否考虑了需要显示业务上需要知道关键的时间节点，如创建时间，注册时间，提交时间，更改时间等
- 是否考虑了实体字段的唯一属性，如单号(\_number)
- 是否考虑了实体字段的非空(not null)属生，检查非空字段 [name, status, ${entity}_number]

##### **_关于显示_**

- 不重要信息是否考虑不用显示在列表中, 如是否包含了用户不关心字段，如 id, 实体关联实体 id 是否转换为实体名称等
- 价格是否**右对齐**, 是否带有货币符号 ￥
- 重要的不同类型与不同状态等枚举通过不同颜色区分 (如状态字段）
- 实体列表是否考虑了需要显示业务上需要知道关键的时间节点，如创建时间，注册时间，提交时间，更改时间等
- 列表中包括其他实体的的单号，用户可以点击单号链接到实体详情
- 列表中如包括下载链接，点击可以直接下载
- 列表, 详情中空的数据, 可用 "-" 横杆显示

##### **_关于排序_**

- 实体列表是否考虑了业务上的时间倒序需求
- 实体列表是否按照排序号倒序排序（排序号大排前面）[后面考虑 code-generator 自动生成代码排序] 上移下移代替排序号

##### **_关于删除逻辑_**

- 检查删除实体时是否 被其他实体依赖 用户尝试删除时提示用户 禁止删除原因
- 删除的实体有子项 删除的类别被实体引用 删除的实体被审批流程引用 删除的实体被其他实体引用
- 订单与历史记录相关实体 不能删除（包括管理员）

##### **_关于重要性_**

- 图片/封面 类型 品牌 等大类排在 名称前面；价格等靠列表右边

##### **_关于过滤查询_**

- 查询正确性：历遍测试所有查询条件，检查结果是否正确；分别检查精确查询与模糊查询是否返回正确
- 查询类型：包括三种类询类型，a.标准的字段查询 b.tab 风格的选择查询（如状态） c.tree 风格查询(如多层级分类）； 测试重要的选择是否采用列表左侧树状控件或列表顶端的 Tab 控件
- 搜索栏：字段较少的列表可采用一个 search 搜索 栏进行过滤 （如名称，条码，标识 可通过一个搜索框录入），搜索栏需要提示可搜索过虑什么字段

##### **_列表操作栏_**

- 列表中重要操作显示出来，不重要的操作折叠起来, 空间足够时尽量多地显示出来(除了删除可以总是折叠)
- 实体状态转移是否通过 列表操作栏进行，而不是在实体编辑中直接保存新状态
- 按钮文字显示数量, 一般控制在 2 ~ 4 个以内

##### **_关于实体状态_**

- 状态原则上不通过 编辑实体时更新，而是通过列表操作栏进行
- 简单的状态转移通过 配置实现，无需写代码

## 实体表单测试

> 实体详情的一般性测试

- 如果实体详情字段不多，只需单列显示
- 表单输入框宽度设置最大宽度（不必占满全屏）
- 考虑表单录入框是否应该必填
- 表单备注字段是否用富文本并支持换行, 并且单列显示
- 选项录入是否通过系统**配置字典**获取
- 表单新建实体时，创建时间及更新时间 不能录入, 只能显示为文体
- 录入**省市区** 需要标准化组件
- 表单编辑实体时, 账号信息不能随意更改

## 压力测试计划

#### 测试工具

> loadrunner 生成专业的压力测试报告

#### **测试方案**

假设设备管理系统有 3000 个用户，平均每天大约有 800 个用户要访问该系统，对一个常用用户来说，一天之内用户从登录到退出该系统的平均时间为 10 分钟约 0.2 小时，在一天的时间内，用户只在 8 小时内使用该系统。

（1） 计算平均的并发用户数： C = nL/T

（2） 并发用户数峰值： C' ≈ C+3 根号 C

公式（1）中，C 是平均的并发用户数；n 是 login session 的数量；L 是 login session 的平均长度；T 指考察的时间段长度。

公式（2）则给出了并发用户数峰值的计算方式中，其中，C'指并发用户数的峰值，C 就是公式（1）中得到的平均的并发用户数。该公式的得出是假设用户的 login session 产生符合泊松分布而估算得到的。

则根据公式（1）和公式（2），可以得到：

C = 800\*0.2/8 = 20

C'≈20+3\*根号 20 = 33

2 个 cpu 8g 内存

每秒产生 10 个用户，总共产生 20 个用户，测试登录,进入到首页,测试结果在  ./tsung/20191123-1534  文件夹下
每秒产生 10 个用户，总共产生 33 个用户，测试登录,进入到首页,测试结果在  ./tsung/20191123-1538  文件夹下

每秒产生 10 个用户，总共产生 20 个用户，测试   添加设备类别,跳到设备列表首页,测试结果在  ./tsung/20191123-1614  文件夹下
每秒产生 10 个用户，总共产生 33 个用户，测试   添加设备类别,跳到设备列表首页,测试结果在  ./tsung/20191123-1624  文件夹下

内存和 cpu 不好截图，因为测试很快结束，cpu 和内存变化很快

## 业务用户数据隔离测试计划

#### 广告主的隔离测试

> - 广告主代表平台客户金主
> - 店小二代表服务客户的平台组织与用户
> - 影院代表平台供应商
> - 商务代表服务供应商的平台组织与用户

##### 广告主自动注册

- 所有店小二主管，平台管理员可以看到已注册的广告主
- 所有店小二不能看到广告主自行注册的广告主
- 平台管理员可以看到所有广告主

##### 广告主自动注册， 店小二主管只能分配广告主给属下的店小二

- 店小二可以看到分配给自已的广告主
- 店小二主管可以看到所有分配到属下店小二的所有广告主
- 其他店小二主管以及其他店小二不能看到没有分配给自已或自已属下的广告主
- 平台管理员可以看到所有广告主 【同上】

##### 店小二创建广告主

- 店小二可以看到所有自已创建的广告主
- 店小二主管可以看到所有分配到属下店小二的所有广告主 【同上】
- 平台管理员可以看到所有广告主 【同上】
- 其他店小二主管不能看到非属下的店二小的 广告主

#### 广告计划的隔离测试

###### admin  为广告主创建广告计划

- 广告主、所有店小二主管，平台管理员可以看到该广告计划，所有店小二不能看到该广告计划

##### 店小二主管为广告主创建广告计划 【同 admin 创建】

- 广告主、创建计划的店小二主管，平台管理员可以看到该广告计划，该店小二主管下的店小二不能看到该广告计划
- 其他店小二，其他店小二主管 不能看到该广告计划，

##### 店小二为广告主创建广告计划

- 广告主、创建计划的店小二，该店小二的主管、平台管理员都 可以看到该广告计划
- 其他店小二，其他店小二主管 不能看到该广告计划，

##### 广告主自已创建计划   后

- 广告主、广告主关联的店小二，该店小二的主管, 平台管理员 可以看到该广告计划
- 其他广告主、其他店小二，其他店小二主管 不能看到该广告计划，

#### 执行订单的隔离测试

- 影院执行的可以看到属于该影院的所有执行订单
- 该影院其他执行人 同样可以看到属于该影院的的执行订单
- 其他影院的所有执行人 不同看到 其他影院的执行订单
- 商务可以看到服务的所有电影院的执行订单
- 商务主管可以看到所有属于的商务服务的所有电影院的执行订单
- 其他商务与其他商务主管不能看到非服务，与非属于的电影院的执行订单

#### 整合科海的数据隔离，以上逻辑是否可以覆盖

- 平台员工的数据隔离，只看到自已的报销信息， 主管可以看到下属员工的所有报销信息 (广告主、广告计划是否可覆盖)
- 外聘供应商的数据隔离 （相当于电影院，作为供应商只能看到属于供应商的所有数据)
- 财务的数据隔离，相当于平台普通用户，由权限控制可以访问的资产，标准的租户隔离
- 合伙人的数据隔离，相当于平台管理角色，某些功能不可用

## 标准测试用例

#### 自动化测试用例

| 编号                     | 测试用例标题          | 步骤说明                                                                                                                                                                                                                                                                         |
| ------------------------ | --------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| TC-API-001 &nbsp; &nbsp; | 时间字段测试用例      | 1. 判断 create_time/ created_time，update_time/updated_time 的逻辑 <br> 2. 列表查询默认用时间倒序 <br/>                                                                                                                                                                          |
| TC-API-002               | 唯一字段测试用例      | 增加同名实体，提示 BusinessCode.DuplictedKey 错误                                                                                                                                                                                                                                |
| TC-API-003               | status 字段测试用例   | 1. 不能通过实体 CRUD 接口更新 status, 需提供新接口更新状态 <br>2. 关于状态 API 的路径规范<br>&nbsp;&nbsp;/api/subsys/entities/{id}/transmit/{status}<br/><br/><br>3. 状态转移判断各种状态之间的转移条件限制，不在条件定义内的状态变更抛出状态错误 BusinessCode.ErrorStatus <br/> |
| TC-API-004               | discount 字段测试用例 | 更新范转定义为 0-100,超出范围报错                                                                                                                                                                                                                                                |
| TC-API-005               | \[其他字段\] 测试用例 |                                                                                                                                                                                                                                                                                  |
| TC-API-101               | 实体删除测试用例      | 有关联的实体不能被删除，如部门下有员工，即部门提示不允许删除                                                                                                                                                                                                                     |

**输入输出测试计划**

1.  检查前端输入合法性

    a) 邮箱 电话 数值 日期 选项框

    b) 支持特殊字符录入 \^&\*(\^(\*\^%\*&%&\^\$&\^\#\#%\$@!\#\~)(&\*)(\^

    c) 空格不作为 查询条件，前端录入空格需要把 头尾空格 Trim 掉

    d) 日期录入格式一致 MM/dd/yyyy 或 yyyy-MM-dd

    e) 备注输入框用富文本，支持换行

2.  增加项

    某字段的唯一性， 唯一字段提示重复

3.  删除项

    如果删除项有其他关联，则不充许删除

4.  列表查询

    每一个过滤条件查询正确，如涉及多表联合查询，可以通过**类别**名称查询, 其他关联表类别查询等

5.  日期条件查询

    涉及日期范围查询 日期范围查询,日期范围涉及比较复杂的逻辑，需要从用户界面，易操作性上考虑，类似 3 日内，1 个月内等方式

6.  列表批量操作

    选择多项内容之后，批量操作，看是否成功。

7.  导入

    导入数据需要提供导入数据模板，对应模板导入数据。

8.  上传

    若上传文件失败，找出上传失败的原因；若上传成功，上传之后的预览、下载和删除是否成功。

9.  检查报表数据格式，数值型报表列向右对齐

**数据库设计测试计划**

1.  如字段需要唯一性，应该在数据库设计级别定义其 Unique 键值

2.  是/否数据类型用 smallint

**开发测试计划**

1.  前端操作测试：检查前端界面操作请求，通过 Chrome 浏览器"开发者工具"查看前端请求是否出错，检查发送到 API 的请求数据是否正确

2.  数据库检查：通过 navcat 数据库界面工具连接数据库，测试用例，检查数据库数据是否业务逻辑正确

3.  测试 API：输入错误参数，API 提供友好提示，不报 500 系统级别错误

**CRUD 业务逻辑测试计划**

1.  状态变更测试，对状态跳转的过程清晰描述，列出状态跳转测试用例，各状态跳转的条件限制是否通过。

2.  一对多数据的增加，删除，更新是否成功:

    a. 新增一对多数据：提交主体数据及多个 items

    b. 更新一对多数据，新增一个 item,
    批量删除多个 item，更新某一个 item 部分数据, 并更新实体部分数据

    c. 更新一对多数据，删除所有 item, 并更新实体部分数据

    d. 尝试删除有一个或多个 items 的实体，不允许删除

    e. 尝试删除没有 items 的实体，成功删除

**测试技巧**

f. 前端操作测试：检查前端界面操作请求，通过 Chrome 浏览器"开发者工具"查看前端请求是否出错，检查发送到 API 的请求数据是否正确

g. 数据库检查：通过 navcat 数据库界面工具连接数据库，测试用例，检查数据库数据是否业务逻辑正确

h. Navcat 下载地址:
