---
title: 表单开发
toc: menu
order: 1
---

## 表单设计

> 业务 主要分为 列表和表单（新建，查看，编辑），二者从业务层面考虑有不同的责任 。

#### 开发从表单业务开始

表单是构成大的业务系统的业务单元，但要做好表单开发并不如想象中容易, 特别是刚参加工作的同学, 对业务通常不够重视, 造成在开发过程中未能专注业务逻辑本身，大量时间花在低价值的范错成本。Java 编程开身就是为业务开发而生，所以如果对业务开发不感兴趣，请转向调研时间比重较高的的底层技术开发

#### 列表业务

> 列表着重展示关键业务数据（用户不关心的关联 id 字段无需显示），重要操作直接在列表中提供（如 与状态转移相关）

> 务即实体的列表查询，实体项的 编辑/删除 操作（以及其他自定义的 操作） 实体新建等。 实休列表与实体新建与编辑有不同的业务表达。

##### 实体列表与实体编辑的区别

- 列表着重关注 关键信息 其他联表信息（如关联表其他字段信息，如用户的部门名称）， 统计信息(如部门的总人数)
- 列表首重实体项操作, 如查看，编辑，删除， 业务操作如状态转移
- 列表首重实体项批量操作,如批量删除，批量提交

#### 表单业务

> 着重展示除列表信息外其他的详细信息，重要的字段变更不能出现在编辑表单中，如状态转换, 财务数据变更等。

> 中的新建表单与编辑表单大部分内容相同，但又有很多值得要考虑的地方，如创建时间新建表单是没有的，但编辑表单是可见而不可编辑的。

#### 实体列表与实体编辑的区别

- 表单着重展示除列表信息外其他的详细信息，重要的字段变更不能出现在编辑表单中，如状态转换, 财务数据变更等。
- 表单负责子项实体列表的显示以及对子项的 CRUD 操作
- 表单负责除实体本身的字段信息外的 其他关联实体信息 审批信息 活动信息 统计信息等

## 表单开发规范

| 对象               | 全局说明                                                                                                                                               | 图示                                                                           |
| ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------ |
| 列表默认数据规则   | 所有列表默认按照数据更新时间由近及远降序排序，分页显示，每页展示十条，数据缺省展示为“-”                                                                |                                                                                |
| 文本框输入数字限制 | 最多输入九位数，数字大小不超过 999999999                                                                                                               |                                                                                |
| 下拉单选框交互     | 多出部分带下拉条、自适应高度、支持单选结果反馈                                                                                                         |                                                                                |
| 下拉多选框交互     | 多出部分带下拉条、自适应高度、支持多选结果反馈、支持反向选择。                                                                                         | <img src="../public/MoreSelect.png" alt="下拉多选框交互" style="zoom:200%;" /> |
| 带搜索下拉框       | 多出部分带下拉条、自适应高度、支持搜索功能                                                                                                             |                                                                                |
| 两级联动下拉框     | 多出部分带下拉条、自适应高度                                                                                                                           | <img src="../public/Down.png" alt="img" style="zoom:200%;" />                  |
| 上传 excle 文件    | 支持扩展名 xls、xlsx，大小不超过 500M。文件格式错误报错：仅支持扩展名为 xls、xlsx，请重新上传！文件大小超限提示：文件大小限制不超过 500M，请重新上传！ |                                                                                |

## 开发规范

#### API 开发规范

- 准实体 CRUD 操作，实体路径需要用复 /entity/entities 进行修饰, 但对于非直接对实体进行 CRUD 操作，即不用复数

```
    # client用复数
    POST /api/crm/entity/entities/{id}

    # client不用复数
    POST /api/crud/entity/bulk/submit
```

- 只有 id 的数据请求，无需通过 Body{} 传送，通过路径传送

```
    POST /api/crud/entity/entities/{id}/action/submit
```

- 批量操作需要转送 id 数据组，通过 Ids 实体传送，Body {"ids":\[\]}

- 实体状态统一通过 PUT 方法, 且需要路径 /action 修饰

```
    POST /api/crud/entity/entities/{id}/action/submit
```

- 实体的批量操作，需要用路径 /bulk 修饰，并且用 POST 方法, 转送批量 id，由 Ids 实体传送

```
    POST /api/crud/entity/bulk/submit Body{"ids":\[\]}
```

- 查询实体 API 常用于表单，表单中常见下拉框选项字段, 由固定 API 提供选项

```
    GET /api/config/fields/{field}
```

> 实体情况返回字段定义如下：

```
   GET /api/crud/entity/entities/{id}
   {
     "id":0,
     "name":"",
     "code":"",
     "note":"",
     "options\_config":
     {
       "cities": \[
         {
           "value":"GZ"
           "title":"广州"
          },
          {
            "value":"BJ"
            "title":"北京"
          }\]
      }
   }
```
